<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title></title>
		<script src="js/jquery-1.12.4.js" type="text/javascript" charset="utf-8"></script>
		<style type="text/css">
			*{
				margin: 0;
				padding: 0;
				font-family: arial;
			}
			.warp{
				width: 610px;
				margin: auto;
				margin-top: 200px;
			}
			.pic img{
				width: 100%;
				height: 100%;
			}
			.pic-list{
				width: 160px;
				height: 230px;
				padding: 20px;
				border-right: 1px solid gainsboro;
				float: left;
			}
			.pic-list p{
				color: gray;
				font-size: 13px;
				line-height: 45px;
			}
			.pic-pri{
				margin-top: 5px;
				float: left;
				font-size: 18px;
				font-weight: bold;
			}
			.pic-pri i{
				font-size: 14px;
				color: gray;
				margin-right: 2px;
				position: relative;
				top: -5px;
			}
			.shop-car{
				width: 100px;
				height: 30px;
				background: darkred;
				color: white;
				border: 1px solid darkred;
				float: right;
			}
			.shopping{
				position: fixed;
				right: 0;
				top: 20px;
			}.shop-num{
				position: absolute;
				top: 0;
				left: 45%;
				width: 15px;
				text-align: center;
				line-height: 15px;
				padding: 5px;
				border-radius: 50%;
				background: red;
				color: white;
			}
			.shop-list{
				position: fixed;
				right: 20px;
				top: 150px;
				width: 200px;
				height: 240px;
				padding: 10px;
				border: 1px solid darkred;
				overflow: auto;
			}
			.shop-list ul{
				height: 230px;
				list-style: none;
			}
			.shop-list img{
				width: 40px;
				height: 40px;
				float: left;
				margin-right: 8px;
			}
			.shop-btn,.shop-btn1{
				width: 15px;
				line-height: 15px;
				float: left;
				border: 1px solid darkgray;
				margin-top: 12px;
			}
			.shop-btn,.shop-btn1:hover{
				cursor: pointer;
			}
			.shop-list span{
				margin-top: 12px;
				width: 25px;
				line-height: 15px;
				float: left;
				display: block;
				border-top: 1px solid darkgray;
				border-bottom: 1px solid darkgray;
			}
			.shop-mon{
				line-height: 40px;
				color: red;
				float: left;
				width: 45px;
				overflow: hidden;
				text-overflow: ellipsis;
				text-align: left;
			}
			.shop-del{
				cursor: pointer;
				float: right;
				line-height: 40px;
			}
			.pic-list b{
				float: left;
				color: red;
			}
			.shop-list b{
				float: left;
				line-height: 40px;
				margin-left: 5px;
			}
			.shop-list p{
				position: absolute;
				bottom: -50px;
				width: 200px;
				padding: 10px;
				left: 0;
			}
			.hj{
				width: 200px;
				padding: 10px;
				position: fixed;
				right: 20px;
				top: 415px;
				background: darkred;
				color: yellow;
			}
			.hj a{
				float: right;
				color: white;
				text-decoration: none;
			}
			.hj b{
				padding: 0 5px;
			}
			.shop-list li{
				border-bottom: 1px dotted darkgray;
				padding: 5px 0;
				text-align: center;
				height: 40px;
			}
		</style>
	</head>
	<body>
		<div class="warp">
			<div class="pic-list">
				<div class="pic">
					<img src="img/TB25hOFjVXXXXXlXXXXXXXXXXXX_!!2471189597.jpg_160x160q90.jpg"/>
				</div>
				<p>智利牛油果</p>
				<b>&yen;</b><div class="pic-pri">25</div>
				<button class="shop-car">加入购物车</button>
			</div>
			<div class="pic-list">
				<div class="pic">
					<img src="img/TB2B2gUkpXXXXbeXXXXXXXXXXXX_!!2471189597.jpg_160x160q90.jpg"/>
				</div>
				<p>利口福荷香罗米鸡</p>
				<b>&yen;</b><div class="pic-pri">18</div>
				<button class="shop-car">加入购物车</button>
			</div>
			<div class="pic-list">
				<div class="pic">
					<img src="img/TB2bZXIabtlpuFjSspfXXXLUpXa_!!2471189597.jpg_160x160q90.jpg"/>
				</div>
				<p>卡士鲜奶酪</p>
				<b>&yen;</b><div class="pic-pri">15</div>
				<button class="shop-car">加入购物车</button>
			</div>
			<div class="pic-list">
				<div class="pic">
					<img src="img/TB2ldNNcFXXXXajXXXXXXXXXXXX_!!2471189597.jpg_160x160q90.jpg"/>
				</div>
				<p>南美白虾仁</p>
				<b>&yen;</b><div class="pic-pri">30</div>
				<button class="shop-car">加入购物车</button>
			</div>
			<div class="pic-list">
				<div class="pic">
					<img src="img/TB2n8MCahvzQeBjSZFqXXXN5VXa_!!2471189597.jpg_160x160q90.jpg"/>
				</div>
				<p>原味三文鱼</p>
				<b>&yen;</b><div class="pic-pri">48</div>
				<button class="shop-car">加入购物车</button>
			</div>
			<div class="pic-list">
				<div class="pic">
					<img src="img/TB2V_J9eFXXXXbVXpXXXXXXXXXX_!!2471189597.jpg_160x160q90.jpg"/>
				</div>
				<p>联豪西冷牛排</p>
				<b>&yen;</b><div class="pic-pri">12</div>
				<button class="shop-car">加入购物车</button>
			</div>
			<p class="hj">合计<b>0</b>元<a href="javascript:;">清空购物车</a></p>
			<div class="shop-list">
				<ul>
					<!--<li>
						<div class="shop-pic"><img src="img/TB25hOFjVXXXXXlXXXXXXXXXXXX_!!2471189597.jpg_160x160q90.jpg"/></div>
						<div class="shop-btn">-</div><span>0</span><div class="shop-btn">+</div>
						<div class="shop-mon">￥9.99</div><div class="shop-del">X</div>
					</li>-->
				</ul>	
			</div>
		</div>
		<div class="shopping">
			<img src="img/g1.png"/>
			<span class="shop-num">0</span>
		</div>
		<script type="text/javascript">
			$(function(){
				var num =0;
				var picnum=0;
				$('.shop-car').each(function(i,ele){
					$(ele).click(function(){
						var pic = $(this).parent().find('.pic');
						var shopImg = $(this).parent().find('.pic').html();
						var shopPri = $(this).parent().find('.pic-pri').html();
						var cloneimg = pic.clone();
						cloneimg.appendTo('body').css({
							width:80,
							height:80,
							border:'1px solid darkred',
							padding:5,
							position: 'absolute',
							top:$(this).offset().top,
							left:$(this).offset().left+$(this).width()
						}).animate({
							width:50,
							height:50,
							opacity:.4,
							top:$('.shopping').offset().top+40,
							left:$('.shopping').offset().left
						},1000,"linear",function(){
							cloneimg.animate({
								width:0,
								height:0,
								opacity:0
							},function(){
								var arrnum=[];
								var arrpic=[];
								var b=0;
								var p=0;
								$('.shop-list li span').each(function(i,ele){
									arrnum[i]=parseInt($(ele).html());
									arrpic[i]=parseInt($('.shop-mon').eq(i).html());
									b+=arrnum[i];
									p+=arrpic[i];
									$('.shop-num').html(b);
									$('.hj b').html(p);
								})
								cloneimg.remove();
							})
						})
						var shoplist=$('<li dataset='+i+'></li>');
//						$('.shop-list li[dataset='+i+']').remove();
						var shopwrap =$('.shop-list ul');
						var num1=0;
						var html ='<div class="shop-pic">'+shopImg+'</div>'+
						'<div class="shop-btn">-</div><span>1</span><div class="shop-btn1">+</div>'+
						'<b>&yen;</b><div class="shop-mon">'+shopPri+'</div><div class="shop-del">X</div></div>'
						shoplist.html(html);
						shopwrap.prepend(shoplist);
						$('.shop-btn').eq(0).css({color:'darkgrey',cursor:'not-allowed'});
//						$('.shop-list li[dataset='+i+']').find('span').html(++picnum);
//						picnum=parseInt($('.shop-list li[dataset='+i+']').find('span').html());
						/*购物车加商品数量*/
						$('.shop-btn1').eq(0).click(function(){
							num1=$(this).parent().find('span').html();
							num1++;
							if(num1>1){
								$(this).prev().prev().css({color:'black',cursor:'pointer'})
							}
							$(this).parent().find('span').html(num1);
							$(this).parent().find('.shop-mon').attr('title',parseFloat(shopPri*num1)).html(parseFloat(shopPri*num1));
							var arrnum=[];
							var arrpic=[];
							var b=0;
							var p=0;
							$('.shop-list li span').each(function(i,ele){
								arrnum[i]=parseInt($(ele).html());
								arrpic[i]=parseInt($('.shop-mon').eq(i).html());
								b+=arrnum[i];
								p+=arrpic[i];
								$('.shop-num').html(b);
								$('.hj b').html(p);
							})
							num=$('.shop-num').html();
						})
						/*购物车减商品数量*/
						$('.shop-btn').eq(0).click(function(){
							num1=$(this).parent().find('span').html();
							num1--;
							if(num1<=1){
								num1=1
								$(this).css({color:'darkgrey',cursor:'not-allowed'});
							}else{
								$(this).css({color:'black',cursor:'pointer'});
							}
							$(this).parent().find('span').html(num1);
							$(this).parent().find('.shop-mon').attr('title',parseFloat(shopPri*num1)).html(parseFloat(shopPri*num1));
							var arrnum=[];
							var arrpic=[];
							var b=0;
							var p=0;
							$('.shop-list li span').each(function(i,ele){
								arrnum[i]=parseInt($(ele).html());
								arrpic[i]=parseInt($('.shop-mon').eq(i).html());
								b+=arrnum[i];
								p+=arrpic[i];
								$('.shop-num').html(b);
								$('.hj b').html(p);
							})
							num=$('.shop-num').html();
						})
						/*删除某一条*/
						$('.shop-del').eq(0).click(function(){
							$(this).parent().remove();
							var arrnum=[];
							var arrpic=[];
							var b=0;
							var p=0;
							$('.shop-list li span').each(function(i,ele){
								arrnum[i]=parseInt($(ele).html());
								arrpic[i]=parseInt($('.shop-mon').eq(i).html());
								b+=arrnum[i];
								p+=arrpic[i];
								$('.shop-num').html(b);
								$('.hj b').html(p);
							})
							if(b==0){
								$('.shop-num').html(0);
								$('.hj b').html(0);
							}
							num=$('.shop-num').html();
						})
						/*清空购物车*/
						$('.hj a').click(function(){
							shopwrap.html("");
							$('.shop-num').html(0);
							$('.hj b').html(0);
						})
					})
				})
			})
		</script>
	</body>
</html>
